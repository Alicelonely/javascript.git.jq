<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        table {
            width: 1000px;
            height: 300px;
            margin: 0 auto;
        }

        table td {
            text-align: center;
            padding: 20px 40px 20px 40px;
        }

        table td .text1 {
            width: 250px;
            cursor: pointer;
            outline: none;
        }

        table tr td span.reduce {
            color: #000;
            background-color: #ddd;
            cursor: pointer;
        }

        table tr td span {
            display: inline-block;
        }

        table tr td span.num {
            margin: 0 0 0 5px;
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <table border="1" cellspacing="0" class="tables">
            <tbody class="tbody1" id="abs">

                <tr>
                    <th colspan="7">简易购物车</th>
                </tr>
                <tr class=".test">
                    <td><input type="checkbox" class="all" onclick="allElection()">全选&nbsp;&nbsp;<input type="checkbox"
                            class="reverse" onclick="reverseElection()">反选</td>
                    <td>商品名称</td>
                    <td>数量(件)</td>
                    <td>单价(元)</td>
                    <td>运费(元)</td>
                    <td>合计</td>
                    <td>操作</td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="election"></td>
                    <td class="nam">双飞燕键盘1</td>
                    <td><span class="reduce redu" onclick="redu1()">-</span><span class="num">0</span> <span class="reduce add"
                            onclick="add1(this)">+</span>
                    </td>
                    <td><span class="price">100</span> </td>
                    <td><span class="freight">25</span></td>
                    <td><span class="tolprice">0</span></td>
                    <td><input type="button" value="删除" class="del"></td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="election"></td>
                    <td class="nam">双飞燕键盘1</td>
                    <td><span class="reduce redu" onclick="redu1()">-</span><span class="num">0</span> <span class="reduce add"
                            onclick="add1(this)">+</span>
                    </td>
                    <td><span class="price">100</span> </td>
                    <td><span class="freight">25</span></td>
                    <td><span class="tolprice">0</span></td>
                    <td><input type="button" value="删除" class="del"></td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="election"></td>
                    <td class="nam">双飞燕键盘1</td>
                    <td><span class="reduce redu" onclick="redu1()">-</span><span class="num">0</span> <span class="reduce add"
                            onclick="add1(this)">+</span>
                    </td>
                    <td><span class="price">100</span> </td>
                    <td><span class="freight">25</span></td>
                    <td><span class="tolprice">0</span></td>
                    <td><input type="button" value="删除" class="del"></td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="election"></td>
                    <td class="nam">双飞燕键盘1</td>
                    <td><span class="reduce redu" onclick="redu1()">-</span><span class="num">0</span> <span class="reduce add"
                            onclick="add1(this)">+</span>
                    </td>
                    <td><span class="price">100</span> </td>
                    <td><span class="freight">25</span></td>
                    <td><span class="tolprice">0</span></td>
                    <td><input type="button" value="删除" class="del"></td>
                </tr>

            </tbody>

            <tfoot>


                <tr>
                    <td>
                        <p>名称:</p>
                        <input type="text" class="name1">
                        <p>数量:</p>
                        <input type="text" class="amount">
                        <p>单价:</p>
                        <input type="text" class="univalence">
                        <p>运费:</p>
                        <input type="text" class="fare"><br>
                        <input type="button" value="确认添加" style="margin-top:10px; " class="affirm" onclick="sdd()">
                    </td>

                    <td colspan="6"><a href="" onclick="Subpages()">请填写邮寄地址</a> <input type="text" class="text1"
                            readonly="readonly" id="sub"> <input type="submit" value="提交订单" onclick="Submission()"><br>
                        <span>总数:</span><span
                            class="totalnum"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <span>总价:</span><span class="total"></span>
                        <br>
                        <input type="button" name="" id="dela" value="删除所选" onclick="delElection()">
                    </td>


                </tr>
            </tfoot>
        </table>
    </div>
    <script src="../jQuery/jquery-1.8.3.min.js"></script>
    <script>











        //数量加


        function add1(thi) {



            $(thi).each(function (i) {

                $(".add").eq(i).each(function (i) {
                    $(".num")[i].innerHTML++;
                    cale(i);
                })


            })


        }





        //数量减
       function redu1() {

                $(".redu").each(function (i) {

                    $(".num")[i].innerHTML--;

                    if ($(".num")[i].innerHTML * 1 <= 0) {
                        $(".num")[i].innerHTML = 0;
                        $(".tolprice")[i].innerHTML = 0;

                    }
                    cale(i)
                })

       }





        //小计总计
        function cale(idx) {

            let talnum = 0,
                talprice = 0;

            let yunfei = $(".freight")[idx].innerHTML;

            if ($(".num")[idx].innerHTML * 1 == 0) {
                yunfei = 0;
            }

            $(".tolprice")[idx].innerHTML = $(".num")[idx].innerHTML * 1 * $(".price")[idx].innerHTML * 1 + yunfei * 1;
            for (let i = 0; i < $(".tolprice").length; i++) {
                talnum += $(".num")[i].innerHTML * 1
                talprice += $(".tolprice")[i].innerHTML * 1
            }

            console.log(talnum, talprice)

            $(".totalnum")[0].innerHTML = talnum;

            $(".total")[0].innerHTML = talprice;
        }


        //添加商品
        function sdd() {

            if ($(".name1").val() != '' && $(".amount").val() != '' && $(".univalence").val() != '' && $(".fare").val() != '') {
                console.log(333)
                let $oTr = $("<tr></tr>");
                // let otd = document.createElement("TD");
                // let oSpan = document.createElement("SPAN");
                // let ipt = document.createElement("INPUT");
                //     ipt.setAttribute("type","checkbox");
                //     ipt.className = "election";
                //     otd.appendChild(ipt);
                //     oTr.appendChild(otd);
                //     // otd.className = "nam";
                //     // otd.innerHTML = `${$(".name1").value}`
                //     // oTr.appendChild(otd);
                //     abs.appendChild(oTr);


                $oTr.html(`
                <td><input type="checkbox" class="election"></td>
                <td class="nam">
                        ${$(".name1").val()}
                    </td>
                <td>
                    <span class="reduce redu" onclick="redu1()">-</span>
                    <span class="num">${$(".amount").val()}</span>
                     <span class="reduce add" onclick="add1()">+</span> 
                </td>
                <td>
                    <span class="price">${$(".univalence").val()}</span>
                </td>
                <td>
                    <span class="freight">${$(".fare").val()}</span>
                </td>
                <td>
                    <span class="tolprice">0</span>
                </td>
                <td>
                    <input type="button" value="删除" class="del">
                </td>
                `)
                $(".tbody1").append($oTr);
               
            }


        }


        //打开子页面
        function Subpages() {
            open("subpages.html", "", "toolbars=0,location=0,statusbars=0,menubars=0,width=736,height=474,scrollbars=0");
        }

        //确认商品
        function Submission() {
            for (let i = 0; i < $(".num").length; i++) {
                if (sub.value !== "") {
                    confirm(`你购买的商品如下:${oTd[0].innerHTML}:${$(".nam")[i].innerHTML}
            ${oTd[1].innerHTML}:${$(".num")[i].innerHTML}
            ${oTd[2].innerHTML}:${$(".price")[i].innerHTML}
            ${oTd[3].innerHTML}:${$(".freight")[i].innerHTML}
            ${oTd[4].innerHTML}:${$(".tolprice")[i].innerHTML}
            送货地址:${sub.value}
            `)
                }
            }

        }

        //删除行

        $(document).on("click", ".del", function () {

            let oTr = this.parentNode.parentNode;
            oTr.parentNode.removeChild(oTr);

        })




        //全选按钮
        function allElection() {

            for (let i = 0; i < $(".election").length; i++) {
                if ($(".all").checked) {
                    if (!$(".election")[i].checked) {
                        $(".election")[i].checked = true;
                    }
                } else {
                    $(".election")[i].checked = false;
                }
            }
        }


        //反选按钮
        function reverseElection() {
            for (let i = 0; i < $(".election").length; i++) {
                if ($(".reverse").checked) {
                    if ($(".election")[i].checked) {
                        $(".election")[i].checked = false;
                    } else {
                        $(".election")[i].checked = true;
                    }
                } else {
                    $(".election")[i].checked = false;
                }
            }

        }


        //删除所选
        function delElection() {
            for (let i = 0; i < $(".election").length; i++) {
                if ($(".election")[i].checked) {
                    let oTr = $(".election")[i].parentNode.parentNode;
                    oTr.parentNode.removeChild(oTr);
                    i--;
                }
            }
        }
    </script>
    <script>

    </script>
</body>


</html>